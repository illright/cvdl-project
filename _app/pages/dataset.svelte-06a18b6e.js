import{S as z,i as C,s as T,B as h,M as Y,N as S,a as j,d as g,O as $,f as p,p as E,K as _,P as w,C as ne,Q as se,R as ie,e as ae,j as b,k as H,c as re,m as M,n as D,b as oe,o as x,F as le,x as B,u as A,v as R,T as ce,U as O,V as F,W as q}from"../chunks/vendor-4fd8af32.js";import{C as ue,T as ge,A as J,B as fe,a as P,e as he,g as me}from"../chunks/action-28bbd5ea.js";import"../chunks/singletons-12a22614.js";import"../chunks/classes-ea0002a8.js";function de(a){let e,o='<path d="M12 2C6.486 2 2 6.486 2 12c.001 5.515 4.487 10.001 10 10.001c5.514 0 10-4.486 10.001-10.001c0-5.514-4.486-10-10.001-10zm0 18.001c-4.41 0-7.999-3.589-8-8.001c0-4.411 3.589-8 8-8c4.412 0 8.001 3.589 8.001 8c-.001 4.412-3.59 8.001-8.001 8.001z" fill="currentColor"/>',n=[{width:"1.2em"},{height:"1.2em"},{preserveAspectRatio:"xMidYMid meet"},{viewBox:"0 0 24 24"},a[0]],r={};for(let t=0;t<n.length;t+=1)r=h(r,n[t]);return{c(){e=Y("svg"),this.h()},l(t){e=S(t,"svg",{width:!0,height:!0,preserveAspectRatio:!0,viewBox:!0});var i=j(e);i.forEach(g),this.h()},h(){$(e,r)},m(t,i){p(t,e,i),e.innerHTML=o},p(t,[i]){$(e,r=E(n,[{width:"1.2em"},{height:"1.2em"},{preserveAspectRatio:"xMidYMid meet"},{viewBox:"0 0 24 24"},i&1&&t[0]]))},i:_,o:_,d(t){t&&g(e)}}}function ve(a,e,o){return a.$$set=n=>{o(0,e=h(h({},e),w(n)))},e=w(e),[e]}class pe extends z{constructor(e){super();C(this,e,ve,de,T,{})}}function _e(a){let e,o='<path d="M20 3H4a1 1 0 0 0-1 1v16a1 1 0 0 0 1 1h16a1 1 0 0 0 1-1V4a1 1 0 0 0-1-1zm-1 16H5V5h14v14z" fill="currentColor"/>',n=[{width:"1.2em"},{height:"1.2em"},{preserveAspectRatio:"xMidYMid meet"},{viewBox:"0 0 24 24"},a[0]],r={};for(let t=0;t<n.length;t+=1)r=h(r,n[t]);return{c(){e=Y("svg"),this.h()},l(t){e=S(t,"svg",{width:!0,height:!0,preserveAspectRatio:!0,viewBox:!0});var i=j(e);i.forEach(g),this.h()},h(){$(e,r)},m(t,i){p(t,e,i),e.innerHTML=o},p(t,[i]){$(e,r=E(n,[{width:"1.2em"},{height:"1.2em"},{preserveAspectRatio:"xMidYMid meet"},{viewBox:"0 0 24 24"},i&1&&t[0]]))},i:_,o:_,d(t){t&&g(e)}}}function $e(a,e,o){return a.$$set=n=>{o(0,e=h(h({},e),w(n)))},e=w(e),[e]}class we extends z{constructor(e){super();C(this,e,$e,_e,T,{})}}function be(a){let e,o='<path d="M12 2C6.486 2 2 6.486 2 12s4.486 10 10 10s10-4.486 10-10S17.514 2 12 2zM4 12c0-1.846.634-3.542 1.688-4.897l11.209 11.209A7.946 7.946 0 0 1 12 20c-4.411 0-8-3.589-8-8zm14.312 4.897L7.103 5.688A7.948 7.948 0 0 1 12 4c4.411 0 8 3.589 8 8a7.954 7.954 0 0 1-1.688 4.897z" fill="currentColor"/>',n=[{width:"1.2em"},{height:"1.2em"},{preserveAspectRatio:"xMidYMid meet"},{viewBox:"0 0 24 24"},a[0]],r={};for(let t=0;t<n.length;t+=1)r=h(r,n[t]);return{c(){e=Y("svg"),this.h()},l(t){e=S(t,"svg",{width:!0,height:!0,preserveAspectRatio:!0,viewBox:!0});var i=j(e);i.forEach(g),this.h()},h(){$(e,r)},m(t,i){p(t,e,i),e.innerHTML=o},p(t,[i]){$(e,r=E(n,[{width:"1.2em"},{height:"1.2em"},{preserveAspectRatio:"xMidYMid meet"},{viewBox:"0 0 24 24"},i&1&&t[0]]))},i:_,o:_,d(t){t&&g(e)}}}function Me(a,e,o){return a.$$set=n=>{o(0,e=h(h({},e),w(n)))},e=w(e),[e]}class xe extends z{constructor(e){super();C(this,e,Me,be,T,{})}}function Be(a){let e,o='<path d="M12 16l4-5h-3V4h-2v7H8z" fill="currentColor"/><path d="M20 18H4v-7H2v7c0 1.103.897 2 2 2h16c1.103 0 2-.897 2-2v-7h-2v7z" fill="currentColor"/>',n=[{width:"1.2em"},{height:"1.2em"},{preserveAspectRatio:"xMidYMid meet"},{viewBox:"0 0 24 24"},a[0]],r={};for(let t=0;t<n.length;t+=1)r=h(r,n[t]);return{c(){e=Y("svg"),this.h()},l(t){e=S(t,"svg",{width:!0,height:!0,preserveAspectRatio:!0,viewBox:!0});var i=j(e);i.forEach(g),this.h()},h(){$(e,r)},m(t,i){p(t,e,i),e.innerHTML=o},p(t,[i]){$(e,r=E(n,[{width:"1.2em"},{height:"1.2em"},{preserveAspectRatio:"xMidYMid meet"},{viewBox:"0 0 24 24"},i&1&&t[0]]))},i:_,o:_,d(t){t&&g(e)}}}function Ae(a,e,o){return a.$$set=n=>{o(0,e=h(h({},e),w(n)))},e=w(e),[e]}class Re extends z{constructor(e){super();C(this,e,Ae,Be,T,{})}}function ze(a){let e,o='<path d="M9 10h6c1.654 0 3 1.346 3 3s-1.346 3-3 3h-3v2h3c2.757 0 5-2.243 5-5s-2.243-5-5-5H9V5L4 9l5 4v-3z" fill="currentColor"/>',n=[{width:"1.2em"},{height:"1.2em"},{preserveAspectRatio:"xMidYMid meet"},{viewBox:"0 0 24 24"},a[0]],r={};for(let t=0;t<n.length;t+=1)r=h(r,n[t]);return{c(){e=Y("svg"),this.h()},l(t){e=S(t,"svg",{width:!0,height:!0,preserveAspectRatio:!0,viewBox:!0});var i=j(e);i.forEach(g),this.h()},h(){$(e,r)},m(t,i){p(t,e,i),e.innerHTML=o},p(t,[i]){$(e,r=E(n,[{width:"1.2em"},{height:"1.2em"},{preserveAspectRatio:"xMidYMid meet"},{viewBox:"0 0 24 24"},i&1&&t[0]]))},i:_,o:_,d(t){t&&g(e)}}}function Ce(a,e,o){return a.$$set=n=>{o(0,e=h(h({},e),w(n)))},e=w(e),[e]}class Te extends z{constructor(e){super();C(this,e,Ce,ze,T,{})}}const V=ne([]);async function ke(a,e,o){const[n,r,t,i]=e.map(Math.round),l=await new Promise(u=>a.toBlob(u,"image/jpeg",.9));l!==null&&V.update(u=>(u.push({data:l,className:o,coordinates:[[n,r],[n+t,r+i]]}),u))}function Ne(){V.update(a=>(a.pop(),a))}function je(a){const e={size:{height:416,width:416},objects:[]};return a.className!=="Nothing"&&e.objects.push({labelerLogin:"_",geometryType:"rectangle",classTitle:a.className,points:{exterior:a.coordinates,interior:[]}}),JSON.stringify(e,null,2)}async function He(a){const e=Math.random().toString(36).substring(2,9),o=new se,n=o.folder("ann"),r=o.folder("img");a.forEach((i,l)=>{const u=`image-${e}-${l}.jpg`;n==null||n.file(`${u}.json`,je(i)),r==null||r.file(u,i.data)});const t=await o.generateAsync({type:"blob"});ie.exports.saveAs(t,`dataset-${e}.zip`)}function De(a){let e,o,n,r,t,i,l,u,d,L,f,v,k,m,N;e=new J({props:{actionName:"Go to the home page",icon:fe}}),e.$on("click",a[4]);function y(s){a[5](s)}let G={toolName:"Circle",icon:pe};a[0]!==void 0&&(G.group=a[0]),n=new P({props:G}),O.push(()=>F(n,"group",y));function ee(s){a[6](s)}let K={toolName:"Rectangle",icon:we};a[0]!==void 0&&(K.group=a[0]),i=new P({props:K}),O.push(()=>F(i,"group",ee));function te(s){a[7](s)}let Q={toolName:"Nothing",icon:xe};return a[0]!==void 0&&(Q.group=a[0]),d=new P({props:Q}),O.push(()=>F(d,"group",te)),v=new J({props:{actionName:"Download dataset",icon:Re,disabled:a[1].length===0,badge:a[1].length!==0?a[1].length.toString():null}}),v.$on("click",a[3]),m=new J({props:{actionName:"Remove last image",icon:Te,disabled:a[1].length===0}}),m.$on("click",Ne),{c(){b(e.$$.fragment),o=H(),b(n.$$.fragment),t=H(),b(i.$$.fragment),u=H(),b(d.$$.fragment),f=H(),b(v.$$.fragment),k=H(),b(m.$$.fragment)},l(s){M(e.$$.fragment,s),o=D(s),M(n.$$.fragment,s),t=D(s),M(i.$$.fragment,s),u=D(s),M(d.$$.fragment,s),f=D(s),M(v.$$.fragment,s),k=D(s),M(m.$$.fragment,s)},m(s,c){x(e,s,c),p(s,o,c),x(n,s,c),p(s,t,c),x(i,s,c),p(s,u,c),x(d,s,c),p(s,f,c),x(v,s,c),p(s,k,c),x(m,s,c),N=!0},p(s,c){const U={};!r&&c&1&&(r=!0,U.group=s[0],q(()=>r=!1)),n.$set(U);const W={};!l&&c&1&&(l=!0,W.group=s[0],q(()=>l=!1)),i.$set(W);const Z={};!L&&c&1&&(L=!0,Z.group=s[0],q(()=>L=!1)),d.$set(Z);const I={};c&2&&(I.disabled=s[1].length===0),c&2&&(I.badge=s[1].length!==0?s[1].length.toString():null),v.$set(I);const X={};c&2&&(X.disabled=s[1].length===0),m.$set(X)},i(s){N||(B(e.$$.fragment,s),B(n.$$.fragment,s),B(i.$$.fragment,s),B(d.$$.fragment,s),B(v.$$.fragment,s),B(m.$$.fragment,s),N=!0)},o(s){A(e.$$.fragment,s),A(n.$$.fragment,s),A(i.$$.fragment,s),A(d.$$.fragment,s),A(v.$$.fragment,s),A(m.$$.fragment,s),N=!1},d(s){R(e,s),s&&g(o),R(n,s),s&&g(t),R(i,s),s&&g(u),R(d,s),s&&g(f),R(v,s),s&&g(k),R(m,s)}}}function Le(a){let e,o,n,r,t;return o=new ue({}),o.$on("object-drawn",a[2]),r=new ge({props:{$$slots:{default:[De]},$$scope:{ctx:a}}}),{c(){e=ae("div"),b(o.$$.fragment),n=H(),b(r.$$.fragment),this.h()},l(i){e=re(i,"DIV",{class:!0});var l=j(e);M(o.$$.fragment,l),n=D(l),M(r.$$.fragment,l),l.forEach(g),this.h()},h(){oe(e,"class","w-full h-screen relative")},m(i,l){p(i,e,l),x(o,e,null),le(e,n),x(r,e,null),t=!0},p(i,[l]){const u={};l&259&&(u.$$scope={dirty:l,ctx:i}),r.$set(u)},i(i){t||(B(o.$$.fragment,i),B(r.$$.fragment,i),t=!0)},o(i){A(o.$$.fragment,i),A(r.$$.fragment,i),t=!1},d(i){i&&g(e),R(o),R(r)}}}function Ye(a,e,o){let n;ce(a,V,f=>o(1,n=f));let r="Circle";async function t({detail:{object:f,fabricReal:v,fabricOffScreen:k}}){const m=await he(f,k);if(m!==null){const[N,y]=m;ke(N,y,r),setTimeout(()=>v.remove(f),500)}}function i(){He(n),V.set([])}const l=()=>me("/draw-ill-help/");function u(f){r=f,o(0,r)}function d(f){r=f,o(0,r)}function L(f){r=f,o(0,r)}return[r,n,t,i,l,u,d,L]}class Se extends z{constructor(e){super();C(this,e,Ye,Le,T,{})}}function Ee(a){let e,o;return e=new Se({}),{c(){b(e.$$.fragment)},l(n){M(e.$$.fragment,n)},m(n,r){x(e,n,r),o=!0},p:_,i(n){o||(B(e.$$.fragment,n),o=!0)},o(n){A(e.$$.fragment,n),o=!1},d(n){R(e,n)}}}class Fe extends z{constructor(e){super();C(this,e,null,Ee,T,{})}}export{Fe as default};
